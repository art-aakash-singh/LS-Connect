<div class="card">
  <div class="flex justify-between items-start mb-6">
    <div>
      <h3 class="text-2xl font-semibold mb-2 text-[var(--text-color)]">
        Safety System Integration
      </h3>
      <p class="text-[var(--text-color-secondary)] text-sm leading-6">
        Configure and manage connections to downstream safety databases
      </p>
    </div>
    <button 
      pButton 
      label="+ Add New System" 
      class="p-button-outlined"
      (click)="showAddSystemDialog()">
    </button>
  </div>

  <p-table [value]="onboardedSystems" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="header">
      <tr>
        <th>System Name</th>
        <th>System Type</th>
        <th>Connection Status</th>
        <th>Last Sync</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-system>
      <tr>
        <td>{{ system.name }}</td>
        <td>{{ system.type }}</td>
        <td>
          <span 
            [ngClass]="{
              'text-green-600': system.connectionStatus === 'Connected',
              'text-red-600': system.connectionStatus === 'Disconnected',
              'text-orange-600': system.connectionStatus === 'Pending'
            }">
            {{ system.connectionStatus }}
          </span>
        </td>
        <td>{{ system.lastSync | date:'yyyy-MM-dd HH:mm':'UTC' }}</td>
        <td>
          <button 
            pButton 
            icon="pi pi-cog" 
            [rounded]="true" 
            [text]="true"
            [routerLink]="['/pages/system/duplicate-search']">
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<!-- Add New System Dialog -->
<p-dialog 
  header="Add New Safety System" 
  [(visible)]="displayDialog"
  [modal]="true"
  [style]="{ width: '600px' }"
  [draggable]="false"
  [resizable]="false">
  
  <div class="space-y-4">
    <!-- Integration Name -->
    <div class="space-y-2">
      <label for="name" class="font-medium text-sm block">
        Integration Name <span class="text-red-500">*</span>
      </label>
      <input
        id="name"
        type="text"
        pInputText
        [(ngModel)]="formData.name"
        placeholder="e.g., Argus Production USA"
        class="w-full" />
    </div>

    <!-- System Type -->
    <div class="space-y-2">
      <label for="systemType" class="font-medium text-sm block">
        System Type <span class="text-red-500">*</span>
      </label>
      <p-select
        inputId="systemType"
        [(ngModel)]="formData.systemType"
        [options]="systemTypes"
        optionLabel="label"
        optionValue="value"
        placeholder="Select System Type"
        class="w-full"
        [style]="{ 'width': '100%' }">
      </p-select>
    </div>

    <!-- Description -->
    <div class="space-y-2">
      <label for="description" class="font-medium text-sm block">
        Description
      </label>
      <textarea
        id="description"
        pTextarea
        [(ngModel)]="formData.description"
        placeholder="Optional description of this integration"
        [rows]="3"
        class="w-full">
      </textarea>
    </div>

    <!-- Active Status -->
    <div class="flex items-center justify-between py-3 border-t border-[var(--surface-border)]">
      <div class="space-y-1">
        <label class="font-medium text-sm block">Active Status</label>
        <p class="text-sm text-[var(--text-color-secondary)]">
          Enable or disable this integration
        </p>
      </div>
      <p-toggleSwitch
        [(ngModel)]="formData.isActive">
      </p-toggleSwitch>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-end gap-3">
      <button 
        pButton 
        label="Cancel" 
        class="p-button-outlined"
        (click)="onCancel()">
      </button>
      <button 
        pButton 
        label="Create" 
        [disabled]="!isFormValid()"
        (click)="onCreate()">
      </button>
    </div>
  </ng-template>
</p-dialog>
